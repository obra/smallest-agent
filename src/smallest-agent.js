import t from"@anthropic-ai/sdk";import{execSync as e}from"child_process";import{createInterface as o}from"readline";const s=new t,i=[],n=console.log,r=(t,e)=>i.push({role:t,content:e}),c=o({input:process.stdin,output:process.stdout});for(let t;t=await new Promise((t=>c.question("> ",t)));)for(r("user",t);;){const{content:t}=await s.messages.create({model:"claude-opus-4-6",max_tokens:4e3,messages:i,tools:[{name:"bash",description:"sh",input_schema:{type:"object",properties:{cmd:{}}}}]}),o=t.find((t=>t.type>"text"));if(r("assistant",t),!o){n(t.find((t=>t.type<"tool"))?.text);break}let c;n(o.input.cmd);try{c=e(o.input.cmd)+""}catch(t){c=t.message}n(c),r("user",[{type:"tool_result",tool_use_id:o.id,content:c}])}
